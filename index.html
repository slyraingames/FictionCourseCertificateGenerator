<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiction Writing 101 - Certificate of Completion</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for a nice script font for the name -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom font for the certificate name */
        .font-caveat {
            font-family: 'Caveat', cursive;
        }
        /* Custom font for the certificate date */
        .font-serif-custom {
            font-family: 'Times New Roman', Times, serif;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex items-center justify-center min-h-screen py-12 px-4">

    <div class="bg-white w-full max-w-2xl mx-auto p-6 sm:p-8 rounded-xl shadow-lg text-center">
        <h1 class="text-3xl font-bold mb-2">Certificate Generator</h1>
        <p class="text-slate-600 mb-6">Enter your name to receive your certificate for completing the Fiction Writing 101 course.</p>

        <!-- Input Section -->
        <div class="mb-4">
            <label for="name-input" class="block text-sm font-medium text-slate-700 mb-2">Your Full Name:</label>
            <input type="text" id="name-input" placeholder="e.g., Jane Doe" class="w-full max-w-md mx-auto p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
        </div>

        <button id="generate-btn" class="w-full max-w-md mx-auto bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition duration-300 ease-in-out text-lg shadow-md hover:shadow-lg disabled:bg-slate-400 disabled:cursor-not-allowed" disabled>
            Loading Certificate...
        </button>

        <!-- Certificate Display and Download Section -->
        <div id="certificate-output" class="hidden mt-8">
            <h2 class="text-2xl font-bold mb-4">Your Certificate is Ready!</h2>
            <!-- The canvas will be used to draw the certificate -->
            <canvas id="certificate-canvas" class="w-full rounded-lg shadow-md border border-slate-200"></canvas>
            
            <a id="download-btn" href="#" download="Fiction_Writing_101_Certificate.png" class="inline-block w-full max-w-md mx-auto bg-green-600 text-white font-bold py-3 px-6 rounded-lg mt-6 hover:bg-green-700 focus:outline-none focus:ring-4 focus:ring-green-300 transition duration-300 ease-in-out text-lg shadow-md hover:shadow-lg">
                Download Certificate
            </a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Elements ---
            const nameInput = document.getElementById('name-input');
            const generateBtn = document.getElementById('generate-btn');
            const certificateOutput = document.getElementById('certificate-output');
            const canvas = document.getElementById('certificate-canvas');
            const downloadBtn = document.getElementById('download-btn');
            const ctx = canvas.getContext('2d');

            // --- Certificate Image ---
            const certificateImage = new Image();
            // This allows loading images from other domains without CORS issues.
            certificateImage.crossOrigin = "anonymous";
            
            // Using the raw image URL from GitHub so the browser can load it directly.
            certificateImage.src = 'https://raw.githubusercontent.com/slyraingames/FictionCourseCertificateGenerator/main/Fiction101Certificate.png'; 
            
            // --- Image Loading Handlers ---
            // This function runs ONLY when the image has successfully loaded.
            certificateImage.onload = () => {
                // Set the canvas dimensions to match the loaded image.
                canvas.width = certificateImage.width;
                canvas.height = certificateImage.height;
                
                // Now that the image is ready, enable the button and update its text.
                generateBtn.disabled = false;
                generateBtn.textContent = 'Generate Certificate';
            };

            // This function runs if the image fails to load (e.g., bad URL).
            certificateImage.onerror = () => {
                console.error("Failed to load the certificate image. Check the URL in the script.");
                generateBtn.textContent = 'Error: Image Failed to Load';
                generateBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                generateBtn.classList.add('bg-red-600');
            };
            
            // --- Event Listener for the Generate Button ---
            generateBtn.addEventListener('click', () => {
                const userName = nameInput.value;

                if (!userName.trim()) {
                    alert('Please enter your name.');
                    return;
                }

                // --- Drawing Logic ---
                // The drawImage call is now safe because this button is only clickable after onload has fired.
                ctx.drawImage(certificateImage, 0, 0, canvas.width, canvas.height);

                // Prepare to draw the name.
                ctx.font = 'bold 70px Caveat';
                ctx.fillStyle = '#1e3a8a'; // A dark blue color
                ctx.textAlign = 'center';
                // **FIXED**: Adjusted Y-coordinate to move the name up slightly more.
                ctx.fillText(userName, canvas.width / 2, 375);

                // Prepare to draw the date.
                const today = new Date();
                const dateString = today.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                ctx.font = '25px "Times New Roman", Times, serif';
                ctx.fillStyle = '#334155'; // A dark gray/slate color
                ctx.textAlign = 'center';
                // Adjusted X and Y coordinates to move the date up and to the left.
                ctx.fillText(dateString, 240, 625);

                // --- Final Steps ---
                certificateOutput.classList.remove('hidden');
                downloadBtn.href = canvas.toDataURL('image/png');
                certificateOutput.scrollIntoView({ behavior: 'smooth' });
            });
        });
    </script>

</body>
</html>
